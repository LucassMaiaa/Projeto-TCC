<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

<!-- Usando o template sem sidebar (2 colunas) -->
<ui:composition template="/WEB-INF/template.xhtml">

	<!-- Título da página -->
	<ui:define name="title">Relatório de Produtividade - BarberSys</ui:define>
	
	<!-- CSS específico desta página -->
	<ui:define name="extra-css">
		<h:outputScript library="primefaces" name="locales/locale-pt.js" />
		<style>
.header-filters {
	margin-top: 9px;
}

body .ui-datatable thead tr:not(.ui-datatable-empty-message), 
body .ui-datatable tbody tr:not(.ui-datatable-empty-message) {
	display: grid;
	    grid-template-columns: 90px 2fr 120px 182px 167px 153px;
}

body .ui-datatable thead th:first-child:not(.ui-datatable-empty-message),
body .ui-datatable tbody td:first-child:not(.ui-datatable-empty-message),
body .ui-datatable thead th:nth-child(3):not(.ui-datatable-empty-message),
body .ui-datatable tbody td:nth-child(3):not(.ui-datatable-empty-message),
body .ui-datatable thead th:nth-child(4):not(.ui-datatable-empty-message),
body .ui-datatable tbody td:nth-child(4):not(.ui-datatable-empty-message),
body .ui-datatable thead th:nth-child(5):not(.ui-datatable-empty-message),
body .ui-datatable tbody td:nth-child(5):not(.ui-datatable-empty-message),
body .ui-datatable thead th:nth-child(6):not(.ui-datatable-empty-message),
body .ui-datatable tbody td:nth-child(6):not(.ui-datatable-empty-message) {
	text-align: center !important;
}

body .ui-datatable .ui-datatable-data>tr>td[colspan="6"] {
	height: 514px;
	font-size: 17px;
}

body .ui-datatable .ui-datatable-even>td {
	background-color: transparent;
}

.ui-datatable-even {
	background-color: #F6F7FB !important;
}

.btn-exportar {
	background: #E74A46 !important;
	border-color: #E74A46 !important;
	border-radius: 50px !important;
	height: 40px !important;
	padding: 0 20px !important;
	display: flex !important;
	align-items: center !important;
	justify-content: center !important;
	gap: 8px;
	font-weight: 600 !important;
	font-size: 12px !important;
	color: white !important;
	text-transform: uppercase;
}

.btn-exportar:hover {
	background: #D13A36 !important;
	border-color: #D13A36 !important;
}

.btn-exportar .ui-button-text {
	padding: 0 !important;
}

.btn-exportar .ui-button-icon-left {
	margin-right: 0 !important;
	position: relative !important;
	left: 0 !important;
	top: 3px !important;
}

.btn-limpar {
	background: #6837DF !important;
	border-color: #6837DF !important;
	border-radius: 50px !important;
	height: 46px !important;
	width: 100% !important;
	padding: 0 20px !important;
	display: flex !important;
	align-items: center !important;
	justify-content: center !important;
	font-weight: 600 !important;
	font-size: 12px !important;
	color: white !important;
	text-transform: uppercase;
}

.btn-limpar:hover {
	background: #5829C7 !important;
	border-color: #5829C7 !important;
}

.btn-limpar .ui-button-text {
	padding: 0 !important;
}

.badge {
	padding: 4px 12px;
	border-radius: 12px;
	font-size: 11px !important;
	font-weight: 600;
	text-transform: uppercase;
	display: inline-block;
	line-height: 1.2;
}

.badge * {
	font-size: 11px !important;
	font-weight: 600;
}

.badge-success {
	background: #28A745;
	color: white;
}

.badge-warning {
	background: #FFC107;
	color: #333;
}

.badge-danger {
	background: #DC3545;
	color: white;
}

.badge-info {
	background: #17A2B8;
	color: white;
}

.badge-secondary {
	background: #6C757D;
	color: white;
}

/* Estilo para o datePicker nos filtros */
.input-combined-no-text .p-datepicker,
.input-combined-no-text .ui-calendar,
.input-combined-no-text .p-calendar {
	width: 100% !important;
	position: relative !important;
	display: inline-flex !important;
}

.input-combined-no-text .p-datepicker .p-inputtext,
.input-combined-no-text .p-datepicker input,
.input-combined-no-text .p-calendar input,
.input-combined-no-text .ui-calendar .ui-inputfield {
	height: 46px !important;
	padding-right: 40px !important;
	padding-left: 12px !important;
	width: 100% !important;
	font-size: 14px !important;
	color: #656464 !important;
	font-weight: 600 !important;
	font-family: "Barlow" !important;
	border-radius: 8px !important;
	box-shadow: none !important;
	border: 1px solid #ced4da !important;
}

/* BOTÃO DO CALENDÁRIO - AZUL PADRÃO DO SISTEMA */
.input-combined-no-text .p-datepicker-trigger,
.input-combined-no-text .p-datepicker button,
.input-combined-no-text .p-calendar button,
.input-combined-no-text .ui-calendar .ui-button.ui-button-icon-only {
	width: 24px !important;
	height: 24px !important;
	min-width: 24px !important;
	position: absolute !important;
	right: 6px !important;
	bottom: 10px !important;
	border-radius: 8px !important;
	display: flex !important;
	align-items: center !important;
	justify-content: center !important;
	background: #457BF9 !important;
	border: transparent !important;
	z-index: 10 !important;
	padding: 0 !important;
}

.input-combined-no-text .p-datepicker-trigger .p-icon,
.input-combined-no-text .p-datepicker button .p-icon,
.input-combined-no-text .p-calendar button .p-icon,
.input-combined-no-text .p-datepicker-trigger svg,
.input-combined-no-text .p-datepicker button svg,
.input-combined-no-text .p-calendar button svg,
.input-combined-no-text .ui-calendar .ui-button.ui-button-icon-only .ui-icon-calendar {
	font-size: 12px !important;
	width: 12px !important;
	height: 12px !important;
	color: white !important;
	position: relative !important;
	top: 1px !important;
	left: 4.3px !important;
}

.input-combined-no-text .p-datepicker-trigger:hover,
.input-combined-no-text .p-datepicker button:hover,
.input-combined-no-text .p-calendar button:hover {
	background: #3667E3 !important;
}

/* Estilo para selectOneMenu nos filtros */
.input-combined-no-text .ui-selectonemenu {
	height: 46px !important;
	width: 100% !important;
}

.input-combined-no-text .ui-selectonemenu .ui-selectonemenu-trigger {
	width: 28px !important;
	height: 46px !important;
	background: transparent !important;
	border: none !important;
	position: absolute !important;
	right: 0px !important;
	top: 0px !important;
	display: flex !important;
	align-items: center !important;
	justify-content: center !important;
}

.input-combined-no-text .ui-selectonemenu .ui-selectonemenu-trigger .ui-icon {
	background: #DEDEDE !important;
	width: 24px !important;
	height: 24px !important;
	display: flex !important;
	align-items: center !important;
	justify-content: center !important;
	border-radius: 8px !important;
	font-size: 12px !important;
	color: black !important;
	margin: 0 !important;
	position: relative !important;
	top: 0px !important;
	left: -6px !important;
	transform: none !important;
}

.input-combined-no-text .ui-selectonemenu .ui-selectonemenu-label {
	height: 46px !important;
	line-height: 46px !important;
	padding: 0 40px 0 12px !important;
	font-size: 14px !important;
	color: #656464 !important;
	font-weight: 600 !important;
	font-family: "Barlow" !important;
}

.input-combined-no-text .ui-selectonemenu.ui-state-focus,
.input-combined-no-text .ui-selectonemenu.ui-state-hover {
	border-color: #ced4da !important;
	box-shadow: none !important;
}

/* Estilo para input de texto dos filtros */
.input-text-filter {
	height: 46px !important;
	padding-left: 12px !important;
	padding-right: 12px !important;
	font-size: 14px !important;
	color: #656464 !important;
	font-weight: 600 !important;
	font-family: "Barlow" !important;
	border-radius: 8px !important;
	box-shadow: none !important;
	border: 1px solid #ced4da !important;
}

/* Estilo para selectOneMenu nos filtros */
.input-combined-no-text .ui-selectonemenu {
	height: 46px !important;
	width: 100% !important;
}

.input-combined-no-text .ui-selectonemenu .ui-selectonemenu-trigger {
	width: 24px !important;
	height: 24px !important;
	border-radius: 8px !important;
	background: #DEDEDE !important;
	border: none !important;
	position: absolute !important;
	right: 8px !important;
	top: 50% !important;
	transform: translateY(-50%) !important;
}

.input-combined-no-text .ui-selectonemenu .ui-selectonemenu-trigger .ui-icon {
	font-size: 12px !important;
	color: black !important;
	margin: 0 !important;
	position: absolute !important;
	top: 50% !important;
	left: 50% !important;
	transform: translate(-50%, -50%) !important;
}

.input-combined-no-text .ui-selectonemenu .ui-selectonemenu-label {
	height: 46px !important;
	line-height: 46px !important;
	padding: 0 40px 0 12px !important;
	font-size: 14px !important;
	color: #656464 !important;
	font-weight: 600 !important;
	font-family: "Barlow" !important;
}

.input-combined-no-text .ui-selectonemenu.ui-state-focus,
.input-combined-no-text .ui-selectonemenu.ui-state-hover {
	border-color: #ced4da !important;
	box-shadow: none !important;
}


		</style>
	</ui:define>

	<!-- Conteúdo CENTRAL da página -->
	<ui:define name="content">
	
		<!-- Título e Botão de Exportar -->
		<div class="flex space-between align-center">
			<p:outputLabel class="title-page" value="Relatório de Produtividade dos Funcionários" />
			<p:commandButton 
				value="Exportar PDF" 
				icon="fa-solid fa-file-pdf"
				styleClass="btn-exportar"
				actionListener="#{relatorioProdutividadeController.gerarPDF()}"
				ajax="false" />
		</div>

			<!-- Filtros -->
			<div class="header-filters">
				<div class="row">
					<div class="col-md-3 input-combined-no-text">
						<p:datePicker 
							showIcon="true"
							value="#{relatorioProdutividadeController.dataInicial}" 
							pattern="dd/MM/yyyy"
							placeholder="Data Inicial">
							<p:ajax update="@form" process="@this" />
						</p:datePicker>
					</div>
					<div class="col-md-3 input-combined-no-text">
						<p:datePicker 
							showIcon="true"
							value="#{relatorioProdutividadeController.dataFinal}" 
							pattern="dd/MM/yyyy"
							placeholder="Data Final">
							<p:ajax update="@form" process="@this" />
						</p:datePicker>
					</div>
					<div class="col-md-4 input-combined-no-text">
						<p:selectOneMenu
							value="#{relatorioProdutividadeController.funcionarioFiltro}"
							filter="true" 
							filterMatchMode="startsWith"
							panelStyle="width: auto;">
							<f:selectItem itemLabel="Pesquisar Funcionário" itemValue="" />
							<f:selectItems var="func"
								value="#{relatorioProdutividadeController.lstFuncionarios}"
								itemLabel="#{func.nome}" itemValue="#{func.id}" />
							<p:ajax update="@form" process="@this" />
						</p:selectOneMenu>
					</div>
					<div class="col-md-2">
						<p:commandButton 
							value="Limpar" 
							styleClass="btn-limpar"
							actionListener="#{relatorioProdutividadeController.limparFiltros()}"
							update="@form"
							process="@this" />
					</div>
				</div>
			</div>

			<!-- Tabela de Produtividade -->
			<div>
				<p:dataTable 
					id="datatableProdutividade"
					value="#{relatorioProdutividadeController.lstProdutividade}" 
					var="prod"
					varStatus="status"
					paginator="true" 
					paginatorPosition="bottom"
					rows="13" 
					lazy="true" 
					emptyMessage="Nenhum dado encontrado">

					<p:column headerText="Código" style="text-align: center;">
						<h:outputText value="#{relatorioProdutividadeController.lstProdutividade.rowIndex + status.index + 1}" />
					</p:column>

					<p:column headerText="Funcionário" sortBy="#{prod.funcionarioNome}">
						<h:outputText value="#{prod.funcionarioNome}" />
					</p:column>

					<p:column headerText="Data" style="text-align: center;" sortBy="#{prod.data}">
						<h:outputText value="#{prod.data}">
							<f:convertDateTime pattern="dd/MM/yyyy" />
						</h:outputText>
					</p:column>

					<p:column headerText="Atendimentos Realizados" style="text-align: center;" sortBy="#{prod.atendimentosRealizados}">
						<span class="badge badge-info">
							<h:outputText value="#{prod.atendimentosRealizados}" />
						</span>
					</p:column>

					<p:column headerText="Taxa de Cancelamento" style="text-align: center;" sortBy="#{prod.taxaCancelamento}">
						<h:outputText value="#{prod.taxaCancelamento}">
							<f:convertNumber type="number" minFractionDigits="2" maxFractionDigits="2" />
						</h:outputText>%
					</p:column>

					<p:column headerText="Média de Avaliações" style="text-align: center;" sortBy="#{prod.mediaAvaliacoes}">
						<span class="badge badge-warning">
							<h:outputText value="#{prod.mediaAvaliacoes}">
								<f:convertNumber type="number" minFractionDigits="1" maxFractionDigits="1" />
							</h:outputText>
						</span>
					</p:column>

				</p:dataTable>
			</div>
	
	</ui:define>

</ui:composition>
</html>
