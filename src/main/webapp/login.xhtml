<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

    <h:head>
        <title>Login</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <link rel="stylesheet" type="text/css" href="#{request.contextPath}/resources/css/global.css"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    </h:head>

    <h:body>
        
        <style>
  	
  		html,body{
  			margin: 0;
  			
  		}
  		
  		body .ui-widget{
  			font-family: 'Barlow', sans-serif;
  		}
  		
  		@font-face {
		    font-family: 'New Order';
		    src: url("#{resource['fonts:NewOrder-Regular.otf']}") format('opentype');
		    font-weight: normal;
		    font-style: normal;
		}
  	
	 	.main{
	 		padding: 20px;
	 		height: 100vh;
	 		box-sizing: border-box;
	 		display: flex;
	 		background-image: linear-gradient(270deg, #fbfbfb, #e7f3f5);
	 	}
	 	
.content-desc {
    box-shadow: 0 0px 5px #d3d3d3;
    border-radius: 8px;
    height: 100%;
    background-image: url(/BarberSys/resources/images/login-barber.svg);
    background-repeat: no-repeat;
    background-position: top right;
    background-size: cover;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    padding: 14.5em 5.625em 5.625em;
    clip-path: polygon(0 0, 100% 0, 95% 100%, 0 100%);
}
	 	
	 	.content-login {
		    flex-grow: 1;
		    display: flex;
		    flex-direction: column;
		    justify-content: center;
	        padding: 4em;
		}
		
		.content-login img{
			align-self: center;
			margin-bottom: 4.375em
		}
		
		.input-combined input{
			width: 100%;
		    min-height: 60px;
		    border: 1px solid #D5D5D5;
		    border-radius: 4px;
		    margin-bottom: 1em;
		    position: relative;
	        padding: 15px 5px 0 40px;
		}
		
		.input-combined input[type="text"]{
			background-image: url(#{request.contextPath}/resources/images/icon_login_email.svg);
			background-repeat: no-repeat;
    		background-position: 8px center;
		}	
		
		.input-combined input[type="password"]{
			background-image: url(#{request.contextPath}/resources/images/icon_login_senha.svg);
			background-repeat: no-repeat;
    		background-position: 8px center;
		}
		
		.input-combined .title-input{
			position: absolute;
			z-index: 1;
			    left: 49px;
		}
		
		.input-combined .ui-outputlabel .ui-outputlabel-label {
		    overflow: hidden;
		    position: absolute;
		    top: 5px;
		    left: 40px;
		    font-size: 0.75em;
		    font-weight: bold;
		}
		
		hr{
			width: 100%;
			margin: 1.09375em 0;
			border-color: #EBEBEB
		}
		
		.flex{
			display: flex;
		}
		
		.flex-end{
			justify-content: flex-end;
		}
		
		.flex-center{
			justify-content: center;
		}
		
		.text-links {
    font-weight: bold;
    color: white !important;
    font-size: 17px !important;
}

	.text-links-black {
    font-weight: bold;
    color: black !important;
    font-size: 14px !important;
}

.text-links-black:hover {
   text-decoration: underline !important;
}
		
		.text-desc {
    font-size: 55px !important;
    text-shadow: 0 0px 1px #1C1E39;
    width: 24ch;
    display: inline-block;
    font-family: 'New Order', sans-serif !important;
    color: white;
    font-weight: 500;
}

@media(max-width: 1446px){
		.text-desc {
    font-size: 46px !important;
}
}
		
		.btn-login.ui-button{
		    height: 3.125em;
		    background: #E74A46;
		    border-radius: 1.5625em;
		    margin-top: 2.8125em;
		    margin-bottom: 4.375em;
		    font-weight: bold;
		    font-size: 1.0625em;
		    border: none;
		    min-height: 54px;
		    transition: all .3s;
		}
		
		.btn-login:hover.ui-button {
		    background: transparent;
		    color: black;
		    border: 1px solid #E74A46;
		}
		
		.content-sobre-sistem {
    width: 11.9em;
    height: 7em;
    border: 2px solid #E9E8E8;
    border-radius: 8px;
    padding: 0.5em;
    display: flex;
    flex-direction: column;
    gap: 8px;
}
		
		.content-sobre-sistem:nth-last-child(2) {
			margin: 0 30px;
		}
		
		.main-desc{
			width: 64%;
		    filter: drop-shadow(0 0px 5px #d3d3d3);
		}
		
		.img-custom{
		    width: 34px;
		}
		
		.icon-input-custom {
    position: absolute;
    z-index: 2;
    font-size: 20px;
    top: 20px;
    left: 15px;
    color: #0D1657;
}

.input-combined .ui-inputfield {
    padding: 22px 7px 0 47px;
}
  	</style>
        
         <h:form styleClass="main">
      <div class="main-desc">
        <div class="content-desc">
          <!-- Conteúdo descritivo, conforme seu design -->
          <div>
            <p:outputLabel styleClass="text-desc" value="Agendamentos fáceis, horários organizados e clientes satisfeitos" />
          </div>
          <!-- Bloco de imagens e textos -->
          <div class="flex">
            <!-- Conteúdo sobre o sistema -->
            <div class="content-sobre-sistem">
              <div>
                <img class="img-custom" src="#{request.contextPath}/resources/images/icon-agendamento.svg" />
              </div>
              <p:outputLabel styleClass="text-links" value="Controle de agendamentos" />
            </div>
            <div class="content-sobre-sistem">
              <div>
                <img class="img-custom" src="#{request.contextPath}/resources/images/icon-inteligente.svg" />
              </div>
              <p:outputLabel styleClass="text-links" value="Sistema inteligente e prático" />
            </div>
            <div class="content-sobre-sistem">
              <div>
                <img class="img-custom" src="#{request.contextPath}/resources/images/icon-faturar.svg" />
              </div>
              <p:outputLabel styleClass="text-links" value="Equipe e faturamento em um só lugar" />
            </div>
          </div>
        </div>
      </div>
      	
      <div class="content-login">
        <img src="#{request.contextPath}/resources/images/logo-login.svg" />
            <p:growl id="mensagens" showDetail="true" life="3000" />
        <div class="input-combined">
        	<i class="icon-input-custom fa-solid fa-envelope"></i>
          <p:outputLabel styleClass="title-input" value="Email" />
          <!-- Vinculando ao atributo 'login' do Managed Bean -->
          <p:inputText styleClass="user-login" value="#{usuarioController.login}" required="true" requiredMessage="Email é obrigatório"/>
        </div>	
      		
        <div class="input-combined">
        <i class="icon-input-custom fa-solid fa-lock"></i>
          <p:outputLabel styleClass="title-input" value="Senha" />
          <!-- Vinculando ao atributo 'senha' do Managed Bean -->
          <p:password styleClass="senha-login" value="#{usuarioController.senha}" required="true" requiredMessage="Senha é obrigatória"/>
        </div>	
      		
        <div class="flex flex-end">
          <h:link outcome="recuperar_senha" styleClass="text-links-black" value="Esqueceu a senha? clique aqui" />
        </div>
      		
        <!-- Botão de login: chama o método efetuarLogin no Managed Bean -->
        <p:commandButton styleClass="btn-login" value="Entrar" 
                         action="#{usuarioController.efetuarLogin()}" 
                         update="@form"
                         oncomplete="handleLoginResponse(args)" />
      		
        <hr/>
      		
        <div class="flex flex-center">
            <h:link outcome="registro" styleClass="text-links-black" value="É novo? cadastre-se clicando aqui " />
        </div>
      		
      </div>
    </h:form>
        
        <script>
            //<![CDATA[
            function handleLoginResponse(args) {
                if (args && args.loginFalhou === true) {
                    // Verifica se o usuário está inativo
                    if (args.usuarioInativo === true) {
                        Swal.fire({
                            icon: 'warning',
                            title: 'Acesso Negado',
                            text: 'Seu cadastro foi desativado. Entre em contato com o administrador do sistema.',
                            confirmButtonText: 'OK',
                            confirmButtonColor: '#E74A46',
                            background: '#fff',
                            backdrop: true
                        });
                    } else {
                        // Credenciais inválidas
                        Swal.fire({
                            icon: 'error',
                            title: 'Erro de Login',
                            text: 'Usuário ou senha inválidos!',
                            confirmButtonText: 'OK',
                            confirmButtonColor: '#E74A46',
                            background: '#fff',
                            backdrop: true
                        });
                    }
                } else if (args && args.redirectUrl) {
                    // Login bem-sucedido, redireciona para a página apropriada
                    window.location.href = args.redirectUrl;
                }
            }
            //]]>
        </script>
        
    </h:body>
</html>

