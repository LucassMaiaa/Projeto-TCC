<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

<!-- Usando o template SEM sidebar -->
<ui:composition template="/WEB-INF/template.xhtml">

	<!-- Título da página -->
	<ui:define name="title">Cadastro de Clientes - BarberSys</ui:define>
	
	<!-- CSS específico desta página -->
	<ui:define name="extra-css">
		<h:outputScript library="primefaces" name="locales/locale-pt.js" />
		<style>
.content-info-lateral {
	background: #FCFCFF;
}

.header-filters {
	margin-top: 9px;
}

.perfil-top-funcionario {
	height: 28px;
	width: 28px;
	background-size: cover;
	margin: 0;
}

.dataList-custom.ui-datalist .ui-datalist-content {
	min-height: 411px;
    height: 411px;
}

body .dataList-dialog-custom.ui-datalist .ui-datalist-content {
	min-height: 211px;
}

body .ui-datalist .ui-datalist-content {
	border: none;
	padding: 0;
}

.dataList-custom.ui-datalist .ui-datalist-empty-message {
	min-height: 379px;
	display: flex;
	justify-content: center;
	align-items: center;
	font-size: 17px !important;
	font-weight: bold;
}

.ui-datalist-item:nth-child(even) .card-list {
	background: #F6F7FB;
}

.card-list {
	padding: 10px 20px;
	align-items: start;
	flex-direction: column;
	gap: 6px;
}

/* Seções do formulário */
.section-title {
	display: flex;
	align-items: center;
	gap: 10px;
	padding-bottom: 10px;
	margin-bottom: 15px;
	border-bottom: 2px solid #E7F3F5;
}

.section-title i {
	color: #4CAF50;
	font-size: 18px;
}

.section-title label {
	font-size: 16px;
	font-weight: 600;
	color: #2C3E50;
	margin: 0;
}

.mt10 {
	margin-top: 10px;
}

.mt20 {
	margin-top: 20px;
}

/* Ajustes no modal */
body .ui-dialog#dlgCli {
	width: 700px !important;
}

.dialog-scroll {
	max-height: 65vh;
	overflow-y: auto;
	overflow-x: hidden;
	padding: 0 15px 15px 0;
	margin-right: -15px;
}

.dialog-scroll::-webkit-scrollbar {
	width: 8px;
}

.dialog-scroll::-webkit-scrollbar-track {
	background: #F5F5F5;
	border-radius: 10px;
}

.dialog-scroll::-webkit-scrollbar-thumb {
	background: #BDBDBD;
	border-radius: 10px;
}

.dialog-scroll::-webkit-scrollbar-thumb:hover {
	background: #9E9E9E;
}

body .ui-dialog:has( .header-modal) .ui-dialog-content, body .ui-dialog:has( .header-modal-confirm) .ui-dialog-content {
   min-width: 1100px;
}

/* Ajustes para o modal de validação de email */
body .ui-dialog.dialog-validar-email .ui-dialog-content {
    min-width: 500px !important;
}

.dialog-validar-email .input-combined .title-input {
    left: 12px !important;
}

.dialog-validar-email .input-combined .ui-inputfield {
  height: 60px !important;
    position: relative !important;
    width: 100% !important;
    border-radius: 8px !important;
    border: 1px solid #D5D5D5 !important;
    background: #FFF !important;
    box-sizing: border-box !important;
    padding: 22px 9px 0 !important;
    font-size: 17px !important;
    color: #656464 !important;
    font-weight: 600 !important;
    font-family: "Barlow" !important;
}
		</style>
	</ui:define>

	<!-- Conteúdo da página -->
	<ui:define name="content">
	
		<!-- Título da página -->
		<div class="flex space-between">
					<p:outputLabel class="title-page" value="Cadastro de Clientes" />
				</div>

				<div class="header-filters">
					<div class="row">
						<div class="col-md-4">
							<div class="content-filter ">
								<i class="fa-solid fa-filter"></i>
								<p:selectOneButton
									value="#{clienteController.statusSelecionado}"
									unselectable="false">
									<f:selectItem itemLabel="Todos" itemValue="" />
									<f:selectItem itemLabel="Ativos" itemValue="A" />
									<f:selectItem itemLabel="Inativos" itemValue="I" />
									<p:ajax update="@form" process="@this" />
								</p:selectOneButton>
							</div>
						</div>
						<div class="col-md-3 input-combined-no-text">
							<p:inputText value="#{clienteController.nomeCliente}" autocomplete="off"
								placeholder="Pesquisar cliente">
								<p:ajax event="keyup" delay="100" update="@form" process="@this" />
							</p:inputText>
							<i class="fa-solid fa-magnifying-glass"></i>
						</div>
					</div>

				</div>

				<div class="flex align-center mt15 mb15">
					<p:commandButton
						actionListener="#{clienteController.novoCliente()}"
						update="form:dlgCli" process="@form" class="btn-circle-green"
						icon="fa fa-plus" oncomplete="PF('dlgCli').show()" />
					<label class="title-button ml8">Novo Cliente</label>
				</div>

				<div>
					<p:dataList rowIndexVar="row" class="dataList-custom"
						value="#{clienteController.lstCliente}" var="clientes"
						paginator="true" paginatorPosition="bottom" rows="16" lazy="true"
						emptyMessage="Nenhum dado encontrado">
						<p:commandLink
							actionListener="#{clienteController.clienteSelecionado(clientes)}"
							update="form:dlgCli" process="@this"
							oncomplete="PF('dlgCli').show()">
							<div class="card-list #{clientes.status == 'I' ? 'inativo' : 'ativo'}">
								<div>
									<label class="title-list">Cliente</label>
									<p:outputLabel styleClass="subtitle-list"
										value="#{clientes.nome}" />
								</div>
								<div>
									<label class="title-list">CPF</label>
									<p:outputLabel styleClass="subtitle-list"
										value="#{clientes.cpf.substring(0,3)}.#{clientes.cpf.substring(3,6)}.#{clientes.cpf.substring(6,9)}-#{clientes.cpf.substring(9,11)}" />
								</div>
							</div>
						</p:commandLink>
					</p:dataList>
				</div>

		<p:dialog id="dlgCli" widgetVar="dlgCli" modal="true"
			showEffect="fade" hideEffect="fade" closable="false"
			draggable="false" resizable="false">
			<h:panelGroup id="dlgCliForm">
				<div class="header-modal">
					<div class="flex align-center">
						<div class="icon-circle">
							<ui:fragment rendered="#{clienteController.editarModel eq 'A'}">
								<i class="fa-solid fa-pen"></i>
							</ui:fragment>
							<ui:fragment rendered="#{clienteController.editarModel eq 'I'}">
								<i class="fa-solid fa-user-plus"></i>
							</ui:fragment>
						</div>
						<label>#{clienteController.editarModel eq 'A' ?
							'Editar Cliente' : 'Novo Cliente'}</label>
					</div>
					<div class="flex align-center">
						<ui:fragment
							rendered="#{clienteController.editarModel eq 'A'}">
							<p:commandButton update="dlgCliForm" process="@form"
								actionListener="#{clienteController.prepararSalvarCliente()}"
								styleClass="btn btn-green" value="Salvar" />
						</ui:fragment>
						<ui:fragment
							rendered="#{clienteController.editarModel eq 'I'}">
							<p:commandButton update="dlgCliForm" process="@form"
								actionListener="#{clienteController.prepararSalvarCliente()}"
								styleClass="btn btn-green" value="Salvar" />
						</ui:fragment>

						<p:commandButton styleClass="btn-x" icon="fa-solid fa-xmark"
							actionListener="#{clienteController.cancelarCliente()}"
							process="@this"
							update="dlgCliForm"
							oncomplete="PF('dlgCli').hide()"/>
					</div>

				</div>

				<div class="dialog-scroll">
				
				<div class="row">
					<div class="col-md-4">
						<div class="content-filter no-filter">
							<p:selectOneButton
								value="#{clienteController.clienteModel.status}"
								unselectable="false">
								<f:selectItem itemLabel="Ativo" itemValue="A" />
								<f:selectItem itemLabel="Inativo" itemValue="I" />
								<p:ajax update="@this" process="@this" />
							</p:selectOneButton>
						</div>
					</div>
				</div>

				<p:messages id="msgs" closable="true" showIcon="true"
					autoUpdate="true" />

				<div class="section-title mt10">
					<i class="fa-solid fa-user-shield"></i>
					<label>Dados de Acesso</label>
				</div>
				
                <div class="row">
					<div class="col-md-12">
						<div class="input-combined">
							<p:outputLabel styleClass="title-input" value="Email *" />
							<p:inputText styleClass="senha-login" autocomplete="off"
								placeholder="Digite o login"
								value="#{clienteController.clienteModel.usuario.login}" />
						</div>
					</div>
				</div>
				
				<div class="row">
                    <div class="col-md-6">
						<div class="input-combined">
							<p:outputLabel styleClass="title-input" value="Senha *" />
							<p:password id="senha1" styleClass="senha-login" autocomplete="off"
								value="#{clienteController.clienteModel.usuario.senha}"
								feedback="true"
								weakLabel="Fraca" goodLabel="Média" strongLabel="Forte"
								promptLabel="Digite uma senha"
								placeholder="#{clienteController.editarModel eq 'A' ? 'Deixe em branco para manter a atual' : ''}" />
						</div>
					</div>
					<div class="col-md-6">
						<div class="input-combined">
							<p:outputLabel styleClass="title-input" value="Confirmar Senha *" />
							<p:password id="senha2" styleClass="senha-login" autocomplete="off"
								value="#{clienteController.confirmarSenha}"
								placeholder="#{clienteController.editarModel eq 'A' ? 'Deixe em branco para manter a atual' : ''}" />
						</div>
					</div>
				</div>
				
				<div class="section-title mt20">
					<i class="fa-solid fa-user"></i>
					<label>Dados Pessoais</label>
				</div>

				<div class="row">
					<div class="col-md-12">
						<div class="input-combined">
							<p:outputLabel styleClass="title-input" value="Nome Completo *" />
							<p:inputText styleClass="senha-login" autocomplete="off"
								placeholder="Digite o nome completo"
								value="#{clienteController.clienteModel.nome}" />
						</div>
					</div>
				</div>

				<div class="row">
					<div class="col-md-6">
						<div class="input-combined">
							<p:outputLabel styleClass="title-input" value="CPF *" />
							<p:inputMask mask="999.999.999-99" styleClass="senha-login"
								placeholder="000.000.000-00"
								value="#{clienteController.clienteModel.cpf}" />
						</div>
					</div>
					<div class="col-md-6">
						<div class="input-combined">
							<p:outputLabel styleClass="title-input" value="Data de Nascimento *" />
							<p:datePicker styleClass="senha-login" pattern="dd/MM/yyyy"
								placeholder="dd/mm/aaaa"
								value="#{clienteController.clienteModel.dataNascimento}" 
								showIcon="true" locale="pt" yearNavigator="true" 
								yearRange="1920:2024" maxdate="#{clienteController.hoje}" />
						</div>
					</div>
				</div>
				
				<!-- CONTATO -->
				<div class="row">
					<div class="col-md-6">
						<div class="input-combined">
							<p:outputLabel styleClass="title-input" value="Telefone *" />
							<p:inputMask mask="(99) 99999-9999" styleClass="senha-login"
								placeholder="(00) 00000-0000"
								value="#{clienteController.clienteModel.telefone}" />
						</div>
					</div>
										<div class="col-md-6">
						<div class="input-combined">
							<p:outputLabel styleClass="title-input" value="Sexo *" />
							<p:selectOneMenu styleClass="senha-login"
								value="#{clienteController.clienteModel.sexo}">
								<f:selectItem itemLabel="Selecione" itemValue="" />
								<f:selectItem itemLabel="Masculino" itemValue="M" />
								<f:selectItem itemLabel="Feminino" itemValue="F" />
								<f:selectItem itemLabel="Outro" itemValue="O" />
							</p:selectOneMenu>
						</div>
					</div>
				</div>
				
				<div class="section-title mt20">
					<i class="fa-solid fa-map-location-dot"></i>
					<label>Endereço</label>
				</div>
				
				<div class="row">
					<div class="col-md-3">
						<div class="input-combined">
							<p:outputLabel styleClass="title-input" value="CEP" />
							<p:inputMask mask="99999-999" styleClass="senha-login"
								value="#{clienteController.clienteModel.cep}" />
						</div>
					</div>
					<div class="col-md-7">
						<div class="input-combined">
							<p:outputLabel styleClass="title-input" value="Rua" />
							<p:inputText styleClass="senha-login"
								value="#{clienteController.clienteModel.rua}" />
						</div>
					</div>
					<div class="col-md-2">
						<div class="input-combined">
							<p:outputLabel styleClass="title-input" value="Número" />
							<p:inputText styleClass="senha-login"
								value="#{clienteController.clienteModel.numero}" />
						</div>
					</div>
				</div>
				
				<div class="row">
					<div class="col-md-4">
						<div class="input-combined">
							<p:outputLabel styleClass="title-input" value="Complemento" />
							<p:inputText styleClass="senha-login"
								value="#{clienteController.clienteModel.complemento}" />
						</div>
					</div>
					<div class="col-md-4">
						<div class="input-combined">
							<p:outputLabel styleClass="title-input" value="Bairro" />
							<p:inputText styleClass="senha-login"
								value="#{clienteController.clienteModel.bairro}" />
						</div>
					</div>
					<div class="col-md-3">
						<div class="input-combined">
							<p:outputLabel styleClass="title-input" value="Cidade" />
							<p:inputText styleClass="senha-login"
								value="#{clienteController.clienteModel.cidade}" />
						</div>
					</div>
					<div class="col-md-1">
						<div class="input-combined">
							<p:outputLabel styleClass="title-input" value="UF" />
							<p:selectOneMenu styleClass="senha-login"
								value="#{clienteController.clienteModel.estado}">
								<f:selectItem itemLabel="UF" itemValue="" />
								<f:selectItem itemLabel="AC" itemValue="AC" />
								<f:selectItem itemLabel="AL" itemValue="AL" />
								<f:selectItem itemLabel="AP" itemValue="AP" />
								<f:selectItem itemLabel="AM" itemValue="AM" />
								<f:selectItem itemLabel="BA" itemValue="BA" />
								<f:selectItem itemLabel="CE" itemValue="CE" />
								<f:selectItem itemLabel="DF" itemValue="DF" />
								<f:selectItem itemLabel="ES" itemValue="ES" />
								<f:selectItem itemLabel="GO" itemValue="GO" />
								<f:selectItem itemLabel="MA" itemValue="MA" />
								<f:selectItem itemLabel="MT" itemValue="MT" />
								<f:selectItem itemLabel="MS" itemValue="MS" />
								<f:selectItem itemLabel="MG" itemValue="MG" />
								<f:selectItem itemLabel="PA" itemValue="PA" />
								<f:selectItem itemLabel="PB" itemValue="PB" />
								<f:selectItem itemLabel="PR" itemValue="PR" />
								<f:selectItem itemLabel="PE" itemValue="PE" />
								<f:selectItem itemLabel="PI" itemValue="PI" />
								<f:selectItem itemLabel="RJ" itemValue="RJ" />
								<f:selectItem itemLabel="RN" itemValue="RN" />
								<f:selectItem itemLabel="RS" itemValue="RS" />
								<f:selectItem itemLabel="RO" itemValue="RO" />
								<f:selectItem itemLabel="RR" itemValue="RR" />
								<f:selectItem itemLabel="SC" itemValue="SC" />
								<f:selectItem itemLabel="SP" itemValue="SP" />
								<f:selectItem itemLabel="SE" itemValue="SE" />
								<f:selectItem itemLabel="TO" itemValue="TO" />
							</p:selectOneMenu>
						</div>
					</div>
				</div>
				
				<div class="section-title mt20">
					<i class="fa-solid fa-comment-dots"></i>
					<label>Preferências do Cliente</label>
				</div>
				
				<div class="row">
					<div class="col-md-12">
						<div class="input-combined">
							<p:outputLabel styleClass="title-input" 
								value="Observações (Ex: Prefiro não conversar durante o atendimento, gosto do corte mais curto em cima, etc.)" />
							<p:inputTextarea styleClass="senha-login" rows="4" maxlength="500"
								value="#{clienteController.clienteModel.observacoes}"
								placeholder="Digite aqui as preferências e observações do cliente..." />
						</div>
					</div>
				</div>
				
				</div><!-- Fecha dialog-scroll -->

			</h:panelGroup>

		</p:dialog>
		
		<!-- Modal de Validação de Email Padronizado -->
		<p:dialog id="dlgValidarEmailCliente" widgetVar="dlgValidarEmailCliente" modal="true" 
			showEffect="fade" hideEffect="fade" closable="false" draggable="false" resizable="false"
			styleClass="dialog-validar-email">
			<h:panelGroup id="dlgValidarEmailClienteForm">
				
				<div class="header-modal">
					<div class="flex align-center">
						<div class="icon-circle">
							<i class="fa-solid fa-envelope-circle-check"></i>
						</div>
						<label>Validar Email</label>
					</div>
					<div class="flex align-center">
						<p:commandButton styleClass="btn-x" icon="fa-solid fa-xmark"
							onclick="PF('dlgValidarEmailCliente').hide()"/>
					</div>
				</div>

				<div style="padding: 20px 20px 0 20px; text-align: center;">
					<p style="margin-bottom: 25px; color: #666; font-size: 14px;">
						Digite o código de 6 dígitos enviado para<br/>
						<strong>#{clienteController.clienteModel.usuario.login}</strong>
					</p>

					<div class="input-combined" style="margin: 0 auto 25px auto; max-width: 280px;">
						<p:outputLabel styleClass="title-input" value="Código de Verificação *" />
						<p:inputText id="codigoValidacaoCliente" 
							value="#{clienteController.codigoValidacao}"
							maxlength="6"/>
					</div>
				</div>

				<div class="flex align-center justify-center" style="padding: 0 20px 20px 20px;">
					<p:commandButton value="Validar" 
						styleClass="btn medium btn-green"
						actionListener="#{clienteController.validarCodigoCliente()}"
						update="dlgValidarEmailClienteForm"
						process="dlgValidarEmailClienteForm"
						ajax="true"/>
						
					<p:commandButton value="Reenviar Código" 
						styleClass="btn medium btn-cancel"
						actionListener="#{clienteController.reenviarCodigoCliente()}"
						update="dlgValidarEmailClienteForm"
						process="@this"/>
				</div>
			</h:panelGroup>
		</p:dialog>


	</ui:define>

</ui:composition>
</html>

