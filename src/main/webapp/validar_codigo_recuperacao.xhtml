<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui">

<h:head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Recuperar Senha - BarberSys</title>
	<link rel="stylesheet" type="text/css" href="#{request.contextPath}/resources/css/global.css"/>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
	
	<style>
		@font-face {
		    font-family: 'New Order';
		    src: url("#{resource['fonts:NewOrder-Regular.otf']}") format('opentype');
		    font-weight: normal;
		    font-style: normal;
		}
	
	 	.main{
	 		padding: 20px;
	 		height: 100vh;
	 		box-sizing: border-box;
	 		display: flex;
	 		background-image: linear-gradient(270deg, #fbfbfb, #e7f3f5);
	 	}
	 	
		.main-desc{
			width: 64%;
		    filter: drop-shadow(0 0px 5px #d3d3d3);
		}

		.content-desc {
		    box-shadow: 0 0px 5px #d3d3d3;
		    border-radius: 8px;
		    height: 100%;
		    background-image: url(#{request.contextPath}/resources/images/login-barber.svg);
		    background-repeat: no-repeat;
		    background-position: top right;
		    background-size: cover;
		    display: flex;
		    flex-direction: column;
		    justify-content: space-between;
		    padding: 14.5em 5.625em 5.625em;
		    clip-path: polygon(0 0, 100% 0, 95% 100%, 0 100%);
		}
		
		.text-desc {
		    font-size: 55px !important;
		    text-shadow: 0 0px 1px #1C1E39;
		    width: 24ch;
		    display: inline-block;
		    font-family: 'New Order', sans-serif !important;
		    color: white;
		    font-weight: 500;
		}
		
		.content-form{
			width: 36%;
			padding: 0 70px;
			display: flex;
			flex-direction: column;
			justify-content: center;
			gap: 16px;
		}
		
		.content-form img {
			width: 200px;
			margin: 0 auto 10px auto;
			display: block;
		}
		
		.icon-input-custom {
		    position: absolute;
		    z-index: 2;
		    font-size: 20px;
		    top: 20px;
		    left: 15px;
		    color: #0D1657;
		}
		
		.input-combined{
			position: relative;
			margin-bottom: 5px;
		}
		
		.input-combined .title-input{
		    position: absolute;
		    top: 7px;
		    left: 47px;
		    font-size: 12px !important;
		    font-weight: bold;
			color: black;
		}

		.input-combined .ui-inputfield,
		.input-combined .ui-password {
		    height: 60px;
		    position: relative;
		    width: 100%;
		    border-radius: 8px !important;
			border: 1px solid #D5D5D5 !important;
			background: #FFF !important;
			box-sizing: border-box;
			padding: 22px 7px 0 47px !important;
		    font-size: 17px !important;
		    color: #656464 !important;
		    font-weight: 600 !important;
		    font-family: "Barlow";
		}
		
		.btn-validar.ui-button{
		    height: 3.125em;
		    background: #E74A46;
		    border-radius: 1.5625em;
		    margin-top: 1.5em;
		    font-weight: bold;
		    font-size: 1.0625em;
		    border: none;
		    min-height: 54px;
		    transition: all .3s;
			width: 100%;
		}
		
		.btn-validar:hover.ui-button {
		    background: transparent;
		    color: black;
		    border: 1px solid #E74A46;
		}
		
		hr{
			width: 100%;
			margin: 1.09375em 0;
			border-color: #EBEBEB
		}
		
		.flex-center{
			display: flex;
			justify-content: center;
			gap: 15px;
		}
		
		.text-links-black {
		    font-weight: bold;
		    color: black !important;
		    font-size: 14px !important;
		}

		.text-links-black:hover {
		   text-decoration: underline !important;
		}
		
		.info-text {
			color: #656464;
			font-size: 14px;
			font-weight: bold;
			text-align: center;
			margin-bottom: 10px;
		}
		
		.flex {
			display: flex;
		}
		
		.content-sobre-sistem {
		    width: 11.9em;
		    height: 7em;
		    border: 2px solid #E9E8E8;
		    border-radius: 8px;
		    padding: 0.5em;
		    display: flex;
		    flex-direction: column;
		    gap: 8px;
		}
		
		.content-sobre-sistem:nth-child(2) {
			margin: 0 30px;
		}
		
		.img-custom{
		    width: 34px;
		}
		
		.text-links {
			font-weight: bold;
			color: white !important;
			font-size: 17px !important;
		}
	</style>
</h:head>

<h:body>
	<h:form id="formValidarCodigo" styleClass="main">
		<!-- Coluna da Esquerda (Design) -->
		<div class="main-desc">
			<div class="content-desc">
				<!-- Conteúdo descritivo -->
				<div>
					<p:outputLabel styleClass="text-desc" value="Agendamentos fáceis, horários organizados e clientes satisfeitos" />
				</div>
				<!-- Bloco de imagens e textos -->
				<div class="flex">
					<!-- Conteúdo sobre o sistema -->
					<div class="content-sobre-sistem">
						<div>
							<img class="img-custom" src="#{request.contextPath}/resources/images/icon-agendamento.svg" />
						</div>
						<p:outputLabel styleClass="text-links" value="Controle de agendamentos" />
					</div>
					<div class="content-sobre-sistem">
						<div>
							<img class="img-custom" src="#{request.contextPath}/resources/images/icon-inteligente.svg" />
						</div>
						<p:outputLabel styleClass="text-links" value="Sistema inteligente e prático" />
					</div>
					<div class="content-sobre-sistem">
						<div>
							<img class="img-custom" src="#{request.contextPath}/resources/images/icon-faturar.svg" />
						</div>
						<p:outputLabel styleClass="text-links" value="Equipe e faturamento em um só lugar" />
					</div>
				</div>
			</div>
		</div>

		<!-- Coluna da Direita (Formulário) -->
		<div class="content-form">
        	<img src="#{request.contextPath}/resources/images/logo-login.svg" alt="Logo BarberSys"/>
			
			<p:messages id="messages" showDetail="true" closable="true" />

			<!-- Etapa 1: Inserir Código -->
			<h:panelGroup rendered="#{!recuperacaoSenhaController.codigoValidado}">
				<p class="info-text">Digite o código de 6 dígitos enviado para seu e-mail.</p>
				
				<div class="input-combined">
					<i class="icon-input-custom fa-solid fa-key"></i>
					<p:outputLabel styleClass="title-input" value="Código de Verificação *" />
					<p:inputText id="codigo" 
                                 value="#{recuperacaoSenhaController.codigoDigitado}"
                                 maxlength="6"
                                 required="true"
                                 requiredMessage="O código é obrigatório" />
				</div>

				<p:commandButton value="Validar Código"
                               styleClass="btn-validar"
                               action="#{recuperacaoSenhaController.validarCodigo}"
                               update="@form" />
			</h:panelGroup>
			
			<!-- Etapa 2: Definir Nova Senha -->
			<h:panelGroup rendered="#{recuperacaoSenhaController.codigoValidado}">
				<p class="info-text">Código validado! Agora, defina sua nova senha.</p>
			
				<div class="input-combined">
					<i class="icon-input-custom fa-solid fa-lock"></i>
					<p:outputLabel styleClass="title-input" value="Nova Senha *" />
					<p:password id="novaSenha" 
                              value="#{recuperacaoSenhaController.novaSenha}"
                              feedback="false"
                              required="true"
                              requiredMessage="A nova senha é obrigatória" />
				</div>

				<div class="input-combined">
					<i class="icon-input-custom fa-solid fa-lock"></i>
					<p:outputLabel styleClass="title-input" value="Confirmar Senha *" />
					<p:password id="confirmarSenha" 
                              value="#{recuperacaoSenhaController.confirmarSenha}"
                              feedback="false"
                              required="true"
                              requiredMessage="A confirmação da senha é obrigatória" />
				</div>

				<p:commandButton value="Redefinir Senha"
                               styleClass="btn-validar"
                               action="#{recuperacaoSenhaController.redefinirSenha}"
                               update="messages" />
			</h:panelGroup>

			<hr />

			<div class="flex-center">
				<h:commandLink action="#{recuperacaoSenhaController.reenviarCodigo}" 
							   styleClass="text-links-black" 
							   value="Reenviar código"
							   rendered="#{!recuperacaoSenhaController.codigoValidado}">
					<f:ajax execute="@this" render="messages" />
				</h:commandLink>

				<h:link outcome="recuperar_senha" styleClass="text-links-black" value="Voltar" />
			</div>
		</div>
	</h:form>
</h:body>
</html>
